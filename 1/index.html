<title>Game Physics in a weekend</title>
<h1>Game Physics in a weekend</h1>



<h2>1. Overview</h2>

<p>Summary and tiny JS implementation of the book <a href="https://gamephysicsweekend.github.io">Game Physics: In One Weekend</a> by Gregory Hodges.


<h2>2. Vectors</h2>
<p>→ Source code: <a href="../engine/vec.js">vec.js</a>
<p>Vectors are 1D arrays containing 2, 3 or 4 numbers, called components.
<br>They either represent a signed displacement (direction + magnitude) or a point in space.
<br>This JS implementation will represent vectors with <a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMPoint">DOMPoint</a>.
<p><code>v2 = new DOMPoint(x, y);        // 2D
v3 = new DOMPoint(x, y, z);     // 3D
v4 = new DOMPoint(x, y, z, w);  // 4D (3D + w component, default: 0, 0, 0, 1)</code>
<p>Methods added: add, sub, mul (component-wise multiplication), scale, dot (dot product), cross (cross product), norm (normalize), mag (magnitude)



<h2>3. Matrices</h2>
<p>Matrices are 2D grids of numbers (2x2, 3x3 or 4x4) representing linear transformations.
<br>This JS implementation will represent matrices with <a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMMatrix">DOMMatrix</a>.
<p><code>m = new DOMMatrix([
  m11, m12, m13, m14,
  m21, m22, m23, m24,
  m31, m32, m33, m34,
  m41, m42, m43, m44
]);</code>
<p>Useful native methods: multiply, inverse, translate, scale, rotate, rotateAxisAngle, transformPoint...
<br>(warning: transpose is not available natively)



<h2>4. Quaternions</h2>
<!--<p>→ Source code: <a href="../engine/quat.js">quat.js</a>-->
<p>Quaternions are often used to represent rotations.
<br>They contain four components x, y, z, w (representing a rotation axis and an angle).
<!--, and will also be implemented with DOMPoint.-->
<br>To save space, this implementation will only use rotation matrices.
<!--<br>Methods added: inverse, mag, mags (magnitude squared), rotatePoint, rotateMatrix, mat (transform into a matrix).-->



<h2>5. Bodies and scene</h2>
<p>→ Source code: <a href="../engine/body.js">body.js</a>, <a href="../engine/body.js">scene.js</a>
<p>A physics simulation is a collection of (colliding) bodies stored in a scene.
<br>A Body has a position p (vector), a center of mass m (vector), an orientation o (matrix) and a shape constant s (1: sphere, 2: box).
<br>A Sphere is an object extending Body with a radius (r) property.
<br>The Scene contains a collection of bodies (b) and two methods: update and render.
<p><b>Demo</b>
<p><iframe src=demo5.html width=640 height=410 frameborder=no></iframe>
<p>World space coordinates are given along the global X, Y, Z axis.
<br>Model space coordinates are relative to a model (ex: a sphere).
<br>worldToBody and bodyToWorld methods are added in the class Body to easily convert a point's coordinates between the two spaces.




<h2>6. Gravity</h2>
<p>Objects move when a force is applied to them. Gravity is a constant downwards force.
<br>After each fraction of time elapsed (dt):
<br> - the change in velocity (dv) is computed from the accelerations (a) using the equation <b>dv = a x dt</b>.
<br>- the change of position (dx) is computed from the velocity (v) using the equation <b>dx = v * dt</b>.
<br>A linear velocity property lv (vector) is added to the class body.



<h2>7. Gravity, masses and impulses</h2>
<p>The engine will treat acceleraion forces (like gravity) as impulses (momentum changes).
<br><b>dv = J / m</b> where J is the impulse and m is the mass.
<br>The im (inverseMass) property and the applyImpulseLinear method are added to the Body class.
<br>Immovable objects are represented with an infinite mass (im = 0).
<p><b>Demo</b>
<p><iframe src=demo7.html width=640 height=660 frameborder=no></iframe>

























<style>
body { font: 15px calibri; padding: 10px; }
h2 { margin: 30px 0 0 0; }
code { display: inline-block; background: #fed; padding: 10px; margin: 10px 0; font: bold 14px/22px courier; white-space: pre; position: relative;}
.f { background: #fde; font-family: arial; }
code.f:before { content: "Formula"; color: #cab; }
p { padding: 0 0 0 10px }
code b.sqrt { border-top: 1px solid; }
</style>